<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>前往 LINE 官方帳號</title>
  <script>
    // --- 可調整參數 ---
    const LINE_OA_URL = "https://page.line.me/584bnrkd"; // 你的 LINE 官方帳號
    const GAS_ENDPOINT = "https://script.google.com/macros/s/AKfycbxps7vHrEUeerhEcARGsFTZyyGqXfKe4cXXaYhltk0aYgBMNfKlEl1Qa4BpnYhQWZ04/exec"; // 之後換成你的 Google Apps Script 網址

    // 取得網址參數
    function getQueryParam(name) {
      const urlParams = new URLSearchParams(window.location.search);
      return urlParams.get(name);
    }

    // 上報到 Google Apps Script（可寫入 Google 試算表）
    async function reportToGAS(data) {
      if (!GAS_ENDPOINT || GAS_ENDPOINT.startsWith("PUT_")) return; // 如果還沒設定，略過
      try {
        await fetch(GAS_ENDPOINT, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data)
        });
      } catch (e) {
        // 靜默失敗，不阻擋導向
      }
    }

    // 主流程
    (async function() {
      const gym = getQueryParam("gym") || "unknown";
      const payload = {
        gym,
        ua: navigator.userAgent,
        ts: new Date().toISOString(),
        referrer: document.referrer
      };
      await reportToGAS(payload);
      // 導向 LINE 官方帳號
      window.location.replace(LINE_OA_URL);
    })();
  </script>
  <style>
    body { font-family: -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol; padding: 24px; }
    .card { max-width: 560px; margin: 40px auto; border: 1px solid #eee; padding: 24px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,.06); }
    h1 { font-size: 20px; margin: 0 0 12px; }
    p { margin: 8px 0; line-height: 1.6; }
    code { background: #f6f8fa; padding: 2px 6px; border-radius: 4px; }
  </style>
</head>
<body>
  <div class="card">
    <h1>前往 LINE 官方帳號中…</h1>
    <p>若 2 秒內未自動跳轉，請<a href="https://page.line.me/584bnrkd">點此</a>前往。</p>
    <p style="font-size: 13px; color: #666;">提示：此頁會記錄來源館別參數 <code>?gym=xxx</code>，用於每月結算合作成效。</p>
  </div>
</body>
</html>

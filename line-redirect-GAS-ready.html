<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <title>Redirect to LINE</title>
    <script>
      const LINE_OA_URL = "https://page.line.me/584bnrkd"; // ä½ çš„ LINE å®˜æ–¹ç¶²å€
      const GAS_ENDPOINT =
        "https://script.google.com/macros/s/AKfycbyFTRsbSqSnIw4t063BrGve44Ft9vrgJszAxWamLduJAXU90P2jZ2A0xhU7WgShEiz/exec"; // GAS Web App é€£çµ

      // æŠ“å–ç¶²å€åƒæ•¸ ?gym=xxx
      function getQueryParam(name) {
        const params = new URLSearchParams(window.location.search);
        return params.get(name);
      }

      // å‚³é€è³‡æ–™ + è·³è½‰ LINE
      async function reportAndRedirect() {
        const data = {
          gym: getQueryParam("gym"),
          ua: navigator.userAgent,
          referrer: document.referrer,
        };

        try {
          const res = await fetch(GAS_ENDPOINT, {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(data),
          });

          const result = await res.json();
          console.log("âœ… GAS å›å‚³çµæœï¼š", result);
        } catch (err) {
          console.warn("âš ï¸ GAS å‚³é€å¤±æ•—ï¼š", err);
        }

        // ğŸ“Œ æˆåŠŸæˆ–å¤±æ•—éƒ½ç…§æ¨£è·³è½‰
        window.location.href = LINE_OA_URL;
      }

      // é é¢è¼‰å…¥æ™‚è‡ªå‹•åŸ·è¡Œ
      reportAndRedirect();
    </script>
  </head>
  <body>
    <p>å³å°‡ç‚ºæ‚¨è·³è½‰è‡³ LINE å®˜æ–¹å¸³è™Ÿ...</p>
  </body>
</html>
